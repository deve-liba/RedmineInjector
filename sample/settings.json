[
  {
    "css": ".subject .js-codecopy-ok:after {\n  content : '[OK]';\n}\n",
    "domain": "",
    "enabled": true,
    "id": "custom_1759320017781_i097qwq0w",
    "javascript": "// 件名をコピーする\n// パブリックな関数名などにsupportをつけることとする。\nfunction prepared_subject_support() {\n\t$('.details .subject:eq(0)').prepend('<a class=\"js-codecopy\" href=\"javascript: void 0;\" onclick=\"copy_subject_support(this);\">件名をコピー</a>');\n\tvar issue_id_obj = document.querySelector('#content h2');\n\tvar subject = document.querySelector('#content .subject h3');\n\tvar issue_id = get_issue_id_support(issue_id_obj);\n\tsubject.textContent = issue_id + subject.textContent;\n}\n\nfunction get_issue_id_support(issue_id_obj) {\n\tif (!issue_id_obj) {\n\t\treturn '';\n\t}\n\t\n\tvar match = issue_id_obj.textContent.match(/#[0-9]+/);\n\n\tif (!match) {\n\t\treturn '';\n\t}\n\t\n\treturn match[0] + ' ';\n}\n\n$(function() {\n\tprepared_subject_support();\n});\n\n// 件名をコピー（テキストのみ）\nvar copy_timeout_support = 0;\nfunction copy_subject_support(obj) {\n\tif (!document.querySelector) {\n\t\talert(\"コピーできませんでした。\\nブラウザが対応していない可能性があります。\");\n\t\treturn;\n\t}\n\n\tvar subject = $(obj).parents('.subject');\n\tvar isSuccess = false;\n\n\tif (!subject[0]) {\n\t\talert('コピーに失敗しました。');\n\t\treturn;\n\t}\n\n\t$(obj).removeClass('js-codecopy-ok');\n\n\tif (copy_timeout_support) {\n\t\tclearTimeout(copy_timeout_support);\n\t}\n\n\ttry {\n\t\t// チケットIDとタイトルを取得\n\t\tvar subject_element = document.querySelector('#content .subject h3');\n\t\tvar subject_text = subject_element.textContent.trim();\n\t\t\n\t\t// テキストのみでクリップボードにコピー\n\t\tnavigator.clipboard.writeText(subject_text).then(function() {\n\t\t\tisSuccess = true;\n\t\t\t$(obj).addClass('js-codecopy-ok');\n\t\t\tconsole.log(obj);\n\t\t\tcopy_timeout_support = setTimeout(function() {$(obj).removeClass('js-codecopy-ok');}, 3000);\n\t\t}).catch(function(err) {\n\t\t\tconsole.error('コピーエラー:', err);\n\t\t\talert('コピーできませんでした。\\nブラウザが対応していない可能性があります。');\n\t\t});\n\t\t\n\t} catch(e) {\n\t\tconsole.error('コピーエラー:', e);\n\t\talert('コピーできませんでした。\\nブラウザが対応していない可能性があります。');\n\t}\n}\n",
    "name": "チケットタイトルにIDを付けてクリップボードコピー機能を付ける",
    "pathPattern": "/issues/[0-9]+"
  },
  {
    "css": ".subject .js-codecopy-withurl-ok:after {\n  content : '[OK]';\n}\n",
    "domain": "",
    "enabled": true,
    "id": "custom_1759320017782_url_copy",
    "javascript": "// 件名をコピー(URL付き) - HTMLリンク形式\nfunction prepared_subject_withurl_support() {\n\t$('.details .subject:eq(0)').prepend('<a class=\"js-codecopy-withurl\" href=\"javascript: void 0;\" onclick=\"copy_subject_with_url_support(this);\">件名をコピー(URL付き)</a> ');\n}\n\n$(function() {\n\tprepared_subject_withurl_support();\n});\n\nvar copy_timeout_withurl_support = 0;\nfunction copy_subject_with_url_support(obj) {\n\tif (!document.querySelector) {\n\t\talert(\"コピーできませんでした。\\nブラウザが対応していない可能性があります。\");\n\t\treturn;\n\t}\n\n\tvar subject = $(obj).parents('.subject');\n\tvar isSuccess = false;\n\n\tif (!subject[0]) {\n\t\talert('コピーに失敗しました。');\n\t\treturn;\n\t}\n\n\t$(obj).removeClass('js-codecopy-withurl-ok');\n\n\tif (copy_timeout_withurl_support) {\n\t\tclearTimeout(copy_timeout_withurl_support);\n\t}\n\n\ttry {\n\t\t// チケットIDとタイトルを取得\n\t\tvar issue_id_obj = document.querySelector('#content h2');\n\t\tvar issue_id_match = issue_id_obj.textContent.match(/#([0-9]+)/);\n\t\t\n\t\tif (!issue_id_match) {\n\t\t\talert('チケットIDが見つかりませんでした。');\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar issue_id = issue_id_match[1];\n\t\tvar subject_element = document.querySelector('#content .subject h3');\n\t\tvar subject_text = subject_element.textContent.trim();\n\t\t\n\t\t// 現在のURLからベースURLを取得\n\t\tvar base_url = window.location.origin;\n\t\tvar issue_url = base_url + '/issues/' + issue_id;\n\t\t\n\t\t// HTMLリンク形式でクリップボードにコピー\n\t\tvar html_content = '<a href=\"' + issue_url + '\">' + subject_text + '</a>';\n\t\tvar text_content = subject_text + ' (' + issue_url + ')';\n\t\t\n\t\t// ClipboardItem APIを使用してHTMLとしてコピー\n\t\tvar clipboardItem = new ClipboardItem({\n\t\t\t'text/html': new Blob([html_content], { type: 'text/html' }),\n\t\t\t'text/plain': new Blob([text_content], { type: 'text/plain' })\n\t\t});\n\t\t\n\t\tnavigator.clipboard.write([clipboardItem]).then(function() {\n\t\t\tisSuccess = true;\n\t\t\t$(obj).addClass('js-codecopy-withurl-ok');\n\t\t\tconsole.log(obj);\n\t\t\tcopy_timeout_withurl_support = setTimeout(function() {$(obj).removeClass('js-codecopy-withurl-ok');}, 3000);\n\t\t}).catch(function(err) {\n\t\t\tconsole.error('コピーエラー:', err);\n\t\t\talert('コピーできませんでした。\\nブラウザが対応していない可能性があります。');\n\t\t});\n\t\t\n\t} catch(e) {\n\t\tconsole.error('コピーエラー:', e);\n\t\talert('コピーできませんでした。\\nブラウザが対応していない可能性があります。');\n\t}\n}\n",
    "name": "件名をコピー(URL付き)",
    "pathPattern": "/issues/[0-9]+"
  }
]